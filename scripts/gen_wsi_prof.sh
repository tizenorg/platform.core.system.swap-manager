#!/bin/sh

lib_file=`rpm -ql webkit2-efl-debuginfo | grep "libewebkit2.so.debug$" | head -1`

inspector_addr=`readelf -sW ${lib_file} | grep ewk_context_inspector_server_start | awk '{print "0x"$2}'`
willexecute_addr=`readelf -sW ${lib_file} | grep ProfileGenerator11willExecute | awk '{print "0x"$2}'`
didexecute_addr=`readelf -sW ${lib_file} | grep ProfileGenerator10didExecute | awk '{print "0x"$2}'`

cat << EOF
/*
 * Autogenerated header
 */

#ifndef WSI_PROF_H_
#define WSI_PROF_H_


static const unsigned long INSPECTOR_ADDR = ${inspector_addr};
static const unsigned long WILLEXECUTE_ADDR = ${willexecute_addr};
static const unsigned long DIDEXECUTE_ADDR = ${didexecute_addr};

#endif /* WSI_PROF_H_ */
EOF
